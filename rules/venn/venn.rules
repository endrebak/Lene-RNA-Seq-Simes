

rule create_venn_diagram_simes_contrasts_overlap:
    input:
        OvsY = "data/simes/OvsY.csv",
        MECvsLEC = "data/simes/MECvsLEC.csv",
        ECIIvsD = "data/simes/ECIIvsD.csv",
    output:
        "data/venn/contrasts.pdf"
    run:
        cmd = """
        library(Vennerable)

        ovsy = read.table("{input.OvsY}", header=1, sep=" ")
        mecvslec = read.table("{input.MECvsLEC}", header=1, sep=" ")
        eciivsd = read.table("{input.ECIIvsD}", header=1, sep=" ")

        ovsy = as.character(ovsy[abs(ovsy$logFC) > 1,]$Gene)
        mecvslec = as.character(mecvslec[abs(mecvslec$logFC) > 1,]$Gene)
        eciivsd = as.character(eciivsd[abs(eciivsd$logFC) > 1,]$Gene)

        # All.list <- list(Layers = LIIvsD.genes, Regions = MECvsLEC.genes, Development = OvsY.genes)

        venn.list = list(Layers=eciivsd, Regions=mecvslec, Development=ovsy)

        pdf("{output[0]}")
        plot(Venn(venn.list), doWeights = TRUE, type = "circles", show = list(Faces = FALSE))
        dev.off()
        """.format(**vars())

        print(cmd)
        R(cmd)
